---
1.写完问题点或者体会之后用水平分割线分离，下次写在水平线下方继续写
2.每次写记录日期
3.重点使用红色字体，方便日后查阅
4.永远坚信技术改变世界。
---

# 项目中遇到的问题点



2021.5.8

1. 首页轮播图默认进去展示一个空图片，本该出现在第一位的图片出现在了第二位，第二次循环就不会出现这个问题
2. <font color=#FF0000> 项目目录问题</font> 
   - 项目整个目录太乱了，由于是第二次做项目，应该算第一次独立完成整个项目，导致整个项目越写越乱。虽然第一次写项目的时候了解了对整个项目的把控，一开始还特地罗列了整个项目的目录结构，但是由于缺少经验，考虑的太少，一开始罗列的目录根本不够用，导致后续很多组件临时找个地方存放，这点在工作中要特别注意，多看看领导对整个项目的划分。
   - 总结：整个项目应该划分为几个目录：
     1. 静态资源目录：存放一些静态图片或者是初始化全局的css亦或者是封装好的工具库，例如对后端返回的时间进行处理的函数
     2. 组件库：这里又要细分两个文件夹，第一个存放当前项目公用的组件，第二个文件存放其他项目可能也能用到的组件
     3. 网络请求：这里存放封装好的网络请求文件
     4. 路由：这里存放路由的配置信息
     5. vuex：这里存放vuex中的配置信息
3. 接口问题：大部分时间都在github上提供的接口上寻找需要的数据，不过这无可厚非，花点时间即可

4. 在浏览器中双击会选中文本，这点在这个项目中不应该出现，目前考虑到只运行在谷歌浏览器中，所以采用在App.vue中模板中第一个div中添加一下代码，阻止该默认行为。

   ~~~javascript
   onselectstart="return false;"
   ~~~

   

-----



2021.5.9

1. 在组件中多个请求使用并发请求，axios.all，单个发送的时候，如果想拦截请求，展示一些加载动画的时候，会重复很多次，比如说页面中发送两个网络请求，请求拦截器拦截第一个请求的时候展示加载动画，然后第一个请求完毕的时候响应拦截器关闭加载动画，理论说这里没问题，请求的时候拦截展示，相应的时候拦截关闭动画，但是这里重点是页面中多个请求，于是实际上就变成了第一个请求展示加载动画，然后响应之后关闭加载动画，（注意这里数据都没全部返回，只能展示页面一部分内容）这还没完！！！！第二个请求又开始拦截请求响应，又特么重新打开了加载动画，第二个请求返回结果之后响应拦截器关掉动画，以此类推，直到所有请求发送且响应完毕才算结束，导致页面出现多次加载动画。下次使用axios发送请求一定要注意这一点。很基础的东西，下个项目不能在犯类似的错误。

-----

2021.5.10

1. 将整个首页布局搭建基本完毕，剩下个歌手和最新音乐两个组件未写，明天晚上将这两个组件搭建完毕，目前由于白天处理学校毕业的事情，还要忙家里店铺的事情，导致只有晚上才有时间搭建项目，这点倒是确实没办法，只能说节约时间吧。
2. 看了下首页七七八八了，回过头处理了input搜索框之前遗留下的问题，input的失去焦点事件与点击事件冲突的问题，具体情况是，当input框获得焦点的时候，弹出当前的搜索榜，点击搜索榜某个元素跳转到对应的搜索结果，然后还有一种情况就是用户点击搜索框，input框获得焦点，然后弹出搜索榜，但是他又放弃搜索，想去其他页面看看，这个时候需要绑定input失去焦点事件，让input失去焦点的时候隐藏搜索榜。这个点的需求就是这样，然后实际上发现，给input绑定了获取焦点事件和失去焦点事件，又给搜索榜的元素绑定点击事件，获得焦点事件没有任何问题，但是失去焦点事件和点击事件冲突了，我们点击搜索榜某个元素的时候，并不会触发点击事件从而跳转到搜索结果页面，而是触发了失去焦点事件，从而使搜索榜消失了，
   1. 原因：这时由于JavaScript是单线程语言，他在同一时刻之做一件事情，加上失去焦点事件优先级高于点击事件，所以就导致触发了失去焦点事件之后再触发点击事件，当JavaScript处理完失去焦点事件后去执行点击事件的时候，搜索榜已经消失了，所以就不会跳转
   2. 解决方法：有两种
      - 第一种：使用定时器延迟失去焦点事件的触发，让结果触发晚300ms，这一点问题不大，用户感觉不出来，但是看着有点垃圾
      - 第二种：将click事件换成mousedown事件，其执行优先于失去焦点事件
        - mousedown事件：当鼠标指针移动到元素上方，并按下鼠标按键时，会发生mousedown事件。
        - mouseup事件：当在元素上放松鼠标按钮时，会发生mouseup事件。
3. 最后一点，对接口返回的数据不敏感，也可以说自己建立的数据的类型不合适，很多时候需要根据我们需要存放什么样的数据决定创建对象还是数组，然后数组里面是对象还是数组等等，目前返回的数据要么丢在对象，要么丢在数组，到底使用的时候不方便，这点需要经验，在工作中慢慢提升这方面的能力
4. 还遗留一个问题，明天处理，轮播图的问题，首页轮播图和电台组件的轮播图，第一行默认展示一张空的，本该第一次就展示的图片跑到第二章，要执行一次轮播图的动画才出现在第一张。

2021.5.12

1. 路由导航的问题，当我们需要在同一个组件中频繁的依靠路由的参数更改数据的时候，这个组件默认只会初始化一次，也就是在第一次切换这个组件的时候才会更新数据，后续我们更改路由的参数重新渲染数据的时候页面不会发生渲染的，因为这个组件没有被销毁，所以就不会执行setup内部的函数,导致页面不会发生刷新

   1. 解决方法：

      - 在路由跳转之前先跳转到一个空页面，在跳转回来，这样这个组件就经过了一次创建的过程，就是看起来有点呆

      - 第二种也是我用的：使用watch属性，vue'3中的watch属性第一个参数默认传入一个响应式对象，如果不是响应式对象则会报错，第二个参数就是一个函数，当监听到数据发生变化做怎么样的处理，代码：

        ~~~javascript
        watch(
              () => router.currentRoute.value.query,
              function () {
                singerid.value = router.currentRoute.value.query.id;
                console.log(singerid.value)
              }
            );
        ~~~


2021.5.13

1. 播放器功能：（项目核心功能）
   - 首先在任何组件中，只要有歌单或者能播放音乐的地方都需要调用这个函数，可以考虑将其抽离出来，避免重复编写，
   - 大部分地方双击播放都是讲整个歌单的添加到播放列表，所以可以请求整个歌单的歌曲id，将所有url放置在vuex的state.songUrl.baseUrl中，
   - 在footed组件中使用watch监听vuex.songUrl.baseUrl的变化，当其发生变化，那么就播放新数据，所以考虑到使用watch，所以在vuex中引入reactive，让watch监听整个响应式对象
2. 问题点：
   - 如何保证将整个歌单中的歌曲的url传到vuex中的同时保证播放当前双击的歌曲(考虑传递url的同时传递一个index标识符，代表着当前歌曲在state.songUrl.baseUrl中的index)，后续播放从index个开始播放，同时也可以使用index来控制上一首和下一首。
   - 对返回的数组进行一个妥善的处理，初步考虑使用class，将后台返回的数据先处理一遍，过滤到不需要的数据，保存需要的数据，代码可能更简洁一点。
   - 进度条的控制，暂时没有思路，到时候可以找一下相应的博客，看下写法。

# 体会

2021.5.8

1. <font color=#FF0000> 封装封装封装思想：一定要勤于封装，无论是组件还是第三方库，特别是第三方库，万一这个库出了点什么问题，只需要修改好我们封装好的文件即可，不需要在整个项目中寻找使用到的组件，然后对其进行修改，这是极其大的工作量</font>
2. 